# utils.py
# Вспомогательные функции и константы для калькуляторов

# ---------------------------------------------
# Методы расчёта аннуитетного платежа
# ---------------------------------------------

def annuity_payment(principal: float, annual_rate: float, years: int) -> float:
    """
    Рассчитывает ежемесячный аннуитетный платёж по кредиту.
    :param principal: сумма кредита (руб.)
    :param annual_rate: годовая ставка (%)
    :param years: срок кредита (лет)
    :return: ежемесячный платёж (руб.)
    """
    r = annual_rate / 100 / 12
    n = years * 12
    return principal * r / (1 - (1 + r) ** -n)

# ---------------------------------------------
# Метод накопления вклада с ежемесячным взносом
# ---------------------------------------------

def accumulate_deposit(monthly: float, annual_rate: float, years: int) -> float:
    """
    Итоговая сумма накоплений при ежемесячном пополнении вклада.
    :param monthly: сумма взноса в месяц (руб.)
    :param annual_rate: ставка вклада (%)
    :param years: срок (лет)
    :return: накопленная сумма (руб.)
    """
    r = annual_rate / 100 / 12
    n = years * 12
    return monthly * (((1 + r) ** n - 1) / r)

# ---------------------------------------------
# Метод дисконтирования с учётом инфляции
# ---------------------------------------------

def adjust_inflation(amount: float, years: float, inflation: float) -> float:
    """
    Приведение будущей суммы к текущей стоимости с учётом инфляции.
    :param amount: будущая сумма (руб.)
    :param years: период (лет)
    :param inflation: инфляция (%)
    :return: приведённая стоимость (руб.)
    """
    return amount / ((1 + inflation / 100) ** years)

# ---------------------------------------------
# Константы для металлопродукции
# ---------------------------------------------
BASE_PRICES = {
    'Урал': {
        'ГК_лист': 44167,
        'ГК_рулон': 40833,
        'ХК_лист': 47083,
        'ХК_рулон': 46250,
        'Оцинк':   59167,
        'Полимер': 72167,
        'Жесть':   80800,
    },
    'Сибирь': {
        'ГК_лист': 44667,
        'ГК_рулон': 41333,
        'ХК_лист': 47583,
        'ХК_рулон': 46750,
        'Оцинк':   59167,
        'Полимер': 72167,
        'Жесть':   80800,
    },
    'Центр Волгоград': {
        'ГК_лист': 43267,
        'ГК_рулон': 39933,
        'ХК_лист': 46183,
        'ХК_рулон': 45350,
        'Оцинк':   59167,
        'Полимер': 72167,
        'Жесть':   80800,
    },
    'Ростов': {
        'ГК_лист': 42167,
        'ГК_рулон': 38833,
        'ХК_лист': 45083,
        'ХК_рулон': 44250,
        'Оцинк':   59167,
        'Полимер': 72167,
        'Жесть':   80800,
    },
    'Москва и Санкт-Петербург': {
        'ГК_лист': 41367,
        'ГК_рулон': 38033,
        'ХК_лист': 44283,
        'ХК_рулон': 43450,
        'Оцинк':   59167,
        'Полимер': 72167,
        'Жесть':   80800,
    },
}

THICKNESS_UP = {
    'ГК_лист':   {'2.5-3.9': 105},
    'ГК_рулон':  {'2.5-3.9': 100},
    'ХК_лист':   {'0.7-0.99':  90},
    'ХК_рулон':  {'0.7-0.99':  85},
    'Оцинк':     {'0.5':      120},
    'Полимер':   {'0.5':      150},
    'Жесть':     {'0.25':     120},
}

GRADE_UP = {
    'нестанд допуск': 10,          # нестандартный допуск — +10 USD
    'сталь 09Г2С': 15,             # марка 09Г2С — +15 USD
    'сталь Ст3пс': 8,              # марка Ст3пс — +8 USD
    'сталь Ст3сп': 8,              # марка Ст3сп — +8 USD
    'оцинковка стандарт': 12,      # оцинкованная сталь — +12 USD
    'полимерное покрытие': 18,     # полимерное покрытие — +18 USD
}
WIDTH_UP = {
    '1000': 40,
    '1250': 55,
}
WEIGHT_COST = {
    'рулон': 3861,
    'пачка': 500,
}
SORT_COEF = {
    'первый': 1.00,
    'второй': 0.90,
    'третий': 0.80,
}
USD_RATE = 100.0
REGION_TARIFF = {
    'Урал': 0.007,                      # чуть выше из-за удалённости и логистики
    'Сибирь': 0.012,                    # Сибирь — самый высокий тариф из-за дальности
    'Москва и Санкт-Петербург': 0.010,  # крупные центры с развитой инфраструктурой
    'Центр Волгоград': 0.009,           # центр с относительно низким тарифом
    'Ростов': 0.011,                    # Ростов ближе к югу, тарифы чуть выше средней
}